Azure IoT Central에서는 장치(여기서는 커피 머신)의 동작과 기능을 정의하는 장치 템플릿에서 장치가 응용 프로그램과 교환할 수 있는 데이터가 지정됩니다. 장치 템플릿을 만들 때는 템플릿에서 시뮬레이션된 장치가 생성됩니다.

시뮬레이션된 장치는 물리적/실제 장치가 연결되기 전에 응용 프로그램의 동작을 테스트할 수 있는 원격 분석을 생성합니다. 

이 단원에서는 다음 기능과 동작을 지정하는 커피 머신에 대해 장치 템플릿을 만듭니다.

### <a name="measurements"></a>측정값

측정값은 장치에서 생성된 데이터입니다. 장치 기능에 맞게 여러 측정값을 장치 템플릿에 추가할 수 있습니다.

* **원격 분석 측정값**: 시간이 지나면 장치를 통해 수집되는 숫자 데이터 요소입니다. 연속 스트림으로 표시됩니다. 이 시나리오에서 원격 분석 측정값은 공기 습도와 수온입니다. 

* **상태 측정값**: 시간에 따른 장치 또는 해당 구성 요소의 상태입니다. 이 시나리오에서는 상태를 끓이는 중/끓이는 중 아님, 컵 있음/컵 없음으로 설정합니다.

### <a name="settings"></a>설정

설정을 사용하여 구성 데이터를 응용 프로그램에서 장치에 보낼 수 있습니다. 이 시나리오에서는 설정에서 최적의 수온을 조정하여 커피 머신으로 보냅니다. 설정이 업데이트된 경우 장치가 설정 변경에 응답했음을 승인할 때까지 UI에서 보류 중으로 표시됩니다.

### <a name="properties"></a>속성

장치와 연결된 장치 메타데이터입니다. 두 가지 형식의 속성이 있습니다.

* *응용 프로그램 속성*은 응용 프로그램에서 장치에 대한 정보를 기록하는 데 사용됩니다. 이 시나리오에서는 응용 프로그램 속성을 사용하여 커피 머신의 이상적인 수온 범위를 설정합니다. 응용 프로그램 속성은 응용 프로그램에 저장되고 장치와 동기화되지 않습니다. 

* 속성 값을 응용 프로그램에 보내도록 장치를 설정하려면 *장치 속성*을 사용할 수 있습니다. 이러한 속성은 장치에서만 변경할 수 있습니다. 이 시나리오에서는 IoT Central에서 장치 보증 만료라고 하는 장치 속성을 구성합니다. 커피 머신이 IoT Central에 연결될 때까지 장치 보증 만료 필드가 빈 상태로 유지됩니다. 커피 머신이 연결되면 응용 프로그램에 보증 상태를 보냅니다. 

### <a name="commands"></a>명령

명령을 사용하여 응용 프로그램에서 장치를 원격으로 관리합니다. 클라우드에서 장치에 대한 명령을 직접 실행하여 장치를 제어할 수 있습니다. 이 시나리오에서는 커피 머신에서 명령을 실행하여 유지 관리 모드로 설정하거나 끓이기를 시작합니다. 

## <a name="create-a-device-template-for-the-coffee-maker"></a>커피 메이커용 장치 템플릿 만들기
장치 템플릿은 장치(여기서는 커피 메이커)의 동작과 기능을 정의합니다.

1. Azure IoT Central 포털에서 응용 프로그램의 **홈**페이지로 이동하고, **장치 템플릿 만들기**를 선택합니다.

> [!TIP]
> 왼쪽 메뉴의 홈 아이콘을 클릭하여 홈페이지에 도달할 수 있습니다.

1. 사용자 지정 장치 템플릿에 *연결된 커피 메이커*를 입력합니다. 
 
1. **만들기**를 선택합니다. 커피 머신의 동작과 기능을 정의하는 커피 메이커에 대해 새 장치 템플릿을 만들었습니다. 

## <a name="define-telemetry-measurements-of-temperature-and-humidity"></a>온도 및 습도의 원격 분석 측정값 정의
1. **연결된 커피 메이커** 장치 템플릿에서 원격 분석을 정의할 **측정값** 페이지로 전환되었는지 확인합니다. 

1. 온도 원격 분석 측정값을 추가하려면 **템플릿 편집** 및 **+ 새 측정값 만들기**를 차례로 선택합니다. 그런 다음, 측정 형식으로 **원격 분석**을 선택합니다.

1. 장치 템플릿에 정의한 각 형식의 원격 분석에는 다음과 같은 구성 옵션이 포함됩니다.
    * 표시 옵션
    * 원격 분석의 세부 정보
    * 시뮬레이션 매개 변수

    온도 및 습도 원격 분석을 구성하려면 다음 표의 정보를 사용합니다. 원격 분석 항목을 만들 때 표의 각 항목에 대해 **+ 새 측정값 만들기**를 선택하여 새 측정값을 추가해야 합니다.
    
    |표시 이름|필드 이름|단위|최소값|최댓값|소수 자릿수|
    |---|---|---|---|---|---|
    |수온|waterTemperature|섭씨|86|100|1|
    |공기 습도|airHumidity|%|20|100|0|
   
    원격 분석 표시용 색을 선택할 수도 있습니다. 원격 분석 정의를 저장하려면 **저장**을 선택합니다. 나머지 모듈에서 측정값, 설정, 속성 및 명령에 대한 추가 정의를 만들 때마다 저장해야 합니다.  

    > [!NOTE]
    > 표에 표시된 필드 이름을 장치 템플릿에 똑같이 입력합니다. 필드 이름이 해당 장치 코드의 속성 이름과 일치하지 않으면 응용 프로그램에서 원격 분석 데이터를 표시할 수 없습니다. 설정 및 속성 정보를 입력할 때도 동일한 작업을 수행합니다.

    ![장치 템플릿 만들기](../media/2-device-template-a.png)

## <a name="define-state-measurement-for-brewingnot-brewing-and-cup-detectedcup-not-detected"></a>끓이는 중/끓이는 중 아님, 컵 있음/컵 없음에 대해 상태 측정값을 정의합니다.
**템플릿 편집** 및 **+ 새 측정값 만들기**를 차례로 선택하여 **측정값** 페이지에서 다음 상태를 추가합니다. 그런 다음, 측정 형식으로 **상태**를 선택합니다.

**상태** > **끓이는 중** 페이지에서 값을 true로 추가합니다. **값** 옆에 있는 **+** 를 클릭하여 다른 값을 false로 추가하고 선택적 표시 이름을 끓이는 중 아님으로 지정합니다. **저장**을 선택하여 편집 내용을 저장합니다.

   |표시 이름|필드 이름|값 1|표시 이름 1|값 2|표시 이름 2|
   |---|---|---|---|---|---|
   |끓이는 중|stateBrewing|true|끓이는 중|false|끓이는 중 아님|
   |컵이 검색됨|stateCupDetected|true|컵이 검색됨|false|컵 없음|

> [!NOTE]
> 원격 분석 및 상태를 정의하면 장치 화면에 장치 템플릿에서 생성된 시뮬레이션 데이터가 표시됩니다. 시뮬레이션 데이터를 사용하면 IoT Central에 물리적 장치를 연결하기 전에 응용 프로그램의 동작을 미리 테스트할 수 있습니다. 

## <a name="set-the-optimal-temperature-of-the-coffee-machine"></a>커피 머신의 최적 온도 설정
**설정** 페이지, **측정값** 옆에 있는 탭으로 이동합니다. **템플릿 편집**을 클릭합니다. **설정** 페이지의 **라이브러리** 아래에서 다음 **숫자** 설정을 추가합니다.

|표시 이름|필드 이름|단위|10진수|최소값|최대값|초기 값|
|---|---|---|---|---|---|---|---|
|최적 온도|setTemperature|섭씨|1|86|100|95|

## <a name="use-properties-to-store-warranty-info-and-water-temperature-range"></a>속성을 사용하여 보증 정보 및 수온 범위 저장

**템플릿 편집**을 선택하여 **속성** 페이지에서 다음 **숫자** 속성을 추가합니다.

|표시 이름|필드 이름|단위|소수 자릿수|최솟값|최대값|초기 값
|---|---|---|---|---|---|---|
|커피 메이커 최소 온도|propertyMinTemperature|섭씨|1|88|92|90|
|커피 메이커 최대 온도|propertyMaxTemperature|섭씨|1|96|99|98| 

**속성** 페이지에서 다음 **장치** 속성을 추가합니다.

   |표시 이름|필드 이름|데이터 형식|
   |---|---|---|
   |장치 보증 만료|propertyWarrantyExpired|숫자|

> [!NOTE]
> 장치(여기서는 커피 머신)에서 장치 속성을 전송합니다. Azure IoT Central에 커피 머신을 연결하고 나면 장치 속성 보증이 응용 프로그램으로 전송되어 장치 보증 만료 필드에 표시됩니다. 

## <a name="use-commands-to-set-maintenance-mode-and-start-brewing"></a>명령을 사용하여 유지 관리 모드 설정 및 끓이기 시작

**템플릿 편집**을 선택하여 **명령** 페이지에서 다음 명령을 추가합니다.

|표시 이름|필드 이름|기본 시간 제한|데이터 형식|
|---|---|---|---|---|---|---|
|유지 관리 모드 설정|cmdSetMaintenance|30|텍스트| 
|끓이기 시작|cmdStartBrewing|30|텍스트|