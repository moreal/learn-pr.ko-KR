회사에서 클라우드로 전환하는 과정의 일환으로 여러 서버를 배포하는 경우를 가정해 보겠습니다. 디스크가 항상 취약성이 없는 상태로 유지되도록 배포 중에 VM 디스크를 암호화해야 합니다. 이 프로세스를 자동화하려고 하며, 암호화를 자동으로 사용하도록 ARM(Azure Resource Manager) 템플릿을 수정해야 합니다.

여기서는 ARM 템플릿을 사용하여 새 Windows VM에 대해 암호화를 자동으로 사용하도록 설정하는 방법을 살펴봅니다.

## <a name="what-are-arm-templates"></a>ARM 템플릿이란?

ARM 템플릿은 가상 머신 등의 Azure에 배포할 리소스를 정의하는 데 사용되는 JSON 파일입니다. 템플릿을 새로 작성할 수도 있고, VM을 비롯한 일부 Azure 리소스의 경우에는 Azure Portal을 사용하여 템플릿을 생성할 수도 있습니다. 수동 VM 배포의 경우에는 필요한 정보를 작성해야 합니다. 하지만 VM을 Azure에 배포하는 대신 템플릿을 저장할 수 있습니다.

예제 템플릿은 GitHub에서 제공됩니다.

## <a name="using-github-templates"></a>GitHub 템플릿 사용

GitHub에는 암호화를 사용하도록 설정하는 데 사용할 수 있는 **실행 중인 Windows VM ARM에서 암호화 사용** 템플릿이 있습니다. 이 템플릿은 [Azure 빠른 시작 템플릿](https://github.com/Azure/azure-quickstart-templates) 리포지토리에 있습니다. 템플릿의 추가 정보 페이지에서 제공되는 Azure에 배포 단추를 클릭하면 Azure Portal에서 템플릿이 열립니다.

이 템플릿을 사용하면 암호화가 사용하도록 미리 설정된 상태로 Windows Server VM을 배포할 수 있습니다. 템플릿을 사용하기 전에 모든 암호화 필수 구성 요소가 준비되어 있는지를 확인해야 합니다. AAD 클라이언트 ID 및 AAD 클라이언트 비밀과 같이 필수 구성 요소 스크립트에서 제공되는 구성 정보도 필요합니다.

템플릿에서 필수 정보를 입력하여 새 VM을 만듭니다. 그런 다음 **구매**를 클릭하여 배치를 시작합니다. 해당 비용은 대개 일반 Azure 계산 저장소 요금입니다.

## <a name="deploy-an-encrypted-vm-by-using-a-template"></a>템플릿을 사용하여 암호화된 VM 배포

템플릿을 사용하여 암호화된 VM을 배포할 때 수행하는 주요 단계는 다음과 같습니다.

1. GitHub에서 **실행 중인 Windows VM ARM에서 암호화 사용** 템플릿에 액세스하여 해당 템플릿을 실행합니다.

1. 스크립트 구성 페이지에서 필요한 세부 정보를 추가합니다.

1. **구매**를 클릭해 스크립트를 사용하여 새 VM을 배포합니다.

1. Azure Portal을 사용하여 디스크 암호화 상태를 확인합니다.
