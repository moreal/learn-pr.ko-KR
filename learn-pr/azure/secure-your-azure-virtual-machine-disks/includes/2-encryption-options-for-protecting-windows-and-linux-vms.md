회사의 거래 업체에 강력한 암호화를 통해 거래 데이터를 보호해야 하는 보안 정책이 있는 경우를 가정해 보겠습니다. Windows 서버에서 실행되며 서버 데이터 디스크에 데이터를 저장하는 B2B 응용 프로그램을 사용하고 있습니다. 이제 클라우드로 전환할 예정이므로, 권한이 없는 사용자/장치/응용 프로그램이 Azure VM에 저장되는 데이터에 액세스할 수 없음을 거래 업체에 보여 주어야 합니다. B2B 데이터의 암호화를 구현하기 위한 전략을 결정해야 합니다.

감사 요구 사항에 따라 암호화 키는 타사가 아닌 내부에서 관리해야 합니다. 또한 Azure 기본 서버의 성능과 관리 효율성도 유지해야 합니다. 따라서 암호화를 구현하기 전에 성능이 저하되지 않도록 해야 합니다.

## <a name="what-is-encryption"></a>암호화란?

암호화는 의미 있는 정보를 무작위 문자 및 숫자 시퀀스와 같이 의미가 없어 보이는 내용으로 변환하는 과정입니다. 암호화 프로세스에서는 암호화된 데이터를 만드는 알고리즘의 일부로 **키** 형식을 사용합니다. 암호 해독을 수행하기 위해서도 키가 필요합니다. 키는 **_대칭_**(암호화와 암호 해독에 같은 키가 사용됨)일 수도 있고 **_비대칭_**(다른 키가 사용됨)일 수도 있습니다. 후자의 예로는 디지털 인증서에 사용되는 **공개-개인** 키 쌍이 있습니다.

### <a name="symmetric-encryption"></a>대칭 암호화

AES(Advanced Encryption Standard)와 같이 대칭 키를 사용하는 알고리즘은 대개 공개 키 알고리즘에 비해 속도가 빠르며 대형 데이터 저장소를 보호하는 데 사용되는 경우가 많습니다. 키가 하나뿐이므로 키 공개를 방지하는 절차가 마련되어 있어야 합니다.

### <a name="asymmetric-encryption"></a>비대칭 암호화

비대칭 알고리즘의 경우에는 키 쌍 중에서 개인 키 멤버만 비공개 상태로 안전하게 유지하면 됩니다. 그리고 이름에서도 알 수 있듯이 공개 키의 경우 암호화된 데이터가 손상되지만 않는다면 누구에게나 제공할 수 있습니다. 하지만 공개 키 알고리즘은 대칭 알고리즘보다 속도가 훨씬 느리며 대량의 데이터를 암호화하는 사용할 수는 없다는 단점이 있습니다.

## <a name="key-management"></a>키 관리

Azure에서는 암호화 키를 Microsoft 또는 고객이 관리할 수 있습니다. HIPAA 또는 기타 규정 준수를 입증해야 하는 조직에서 고객 관리 키를 요청하는 경우가 많습니다. 이러한 규정을 준수하려면 키 액세스를 로깅해야 할 수 있으며, 키를 정기적으로 변경하고 해당 변경을 기록해야 할 수 있습니다.

## <a name="azure-disk-encryption-technologies"></a>Azure Disk Encryption 기술

Azure VM의 기본 암호화 기반 디스크 보호 기술은 다음과 같습니다.

- SSE(Storage 서비스 암호화)
- ADE(Azure Disk Encryption)

### <a name="storage-service-encryption"></a>저장소 서비스 암호화

Azure SSE(저장소 서비스 암호화)는 미사용 데이터를 보호하는 데 사용되는 Azure의 기본 제공 암호화 서비스입니다. Azure 저장소 플랫폼에서는 데이터가 Azure Managed Disks를 비롯한 여러 저장소 서비스에 저장되기 전에 자동으로 암호화됩니다. 암호화는 256비트 AES 암호화를 통해 기본적으로 사용하도록 설정되며, 저장소 계정 관리자가 관리합니다.

### <a name="azure-disk-encryption"></a>Azure Disk Encryption

ADE(Azure Disk Encryption)는 VM 소유자가 관리합니다. Windows VM의 **BitLocker** 및 Linux VM의 **DM-Crypt**를 사용하여 Windows 및 Linux VM 제어 디스크의 암호화를 제어합니다. 운영 체제와 통합된 데이터 보호 기능인 BitLocker 드라이브 암호화는 분실, 도난 또는 부적절하게 서비스 해제된 컴퓨터에서 데이터가 노출되거나 도용될 위협을 해결합니다. 마찬가지로 DM-Crypt는 Linux의 미사용 데이터를 저장소에 쓰기 전에 암호화합니다.

ADE는 Azure Storage에서 미사용 상태인 VM 디스크의 모든 데이터가 암호화되도록 하며, ADE는 Recovery Vault에 백업된 VM에 필요합니다.

ADE를 사용하면 VM은 고객 제어 키와 정책에 따라 부팅됩니다. 이러한 디스크 암호화 키 및 비밀을 관리할 수 있도록 ADE는 Azure Key Vault에 통합됩니다.

> [!NOTE] 
> ADE는 기본 계층 VM 암호화는 지원하지 않으며, 온-프레미스 KMS(키 관리 서비스)는 ADE와 함께 사용할 수 없습니다.

## <a name="when-to-use-encryption"></a>암호화를 사용하는 경우는?

컴퓨터 데이터는 전송 중(인터넷 또는 기타 네트워크를 통해 전송)일 때와 미사용(저장 장치에 저장)일 때 위험합니다. Azure VM 디스크의 데이터를 보호할 때는 미사용 데이터 보호를 기본적으로 설정해야 합니다. Azure VM과 연결된 VHD(가상 하드 디스크) 파일을 다운로드하여 노트북에 저장하는 경우를 예로 들어 보겠습니다. 이때 VHD가 암호화되어 있지 않으면 컴퓨터에 VHD 파일을 탑재할 수 있는 모든 사용자가 VHD의 콘텐츠에 액세스할 수 있게 됩니다.

OS(운영 체제) 디스크의 경우에는 암호 등의 데이터가 자동으로 암호화되므로 VHD 자체가 암호화되어 있지 않더라도 해당 정보에 액세스하기는 어렵습니다. 응용 프로그램이 자체 데이터를 자동으로 암호화할 수도 있습니다. 하지만 이와 같은 보호 수단을 사용하더라도 악의적인 사용자가 데이터 디스크 액세스 권한을 확보하는 경우 디스크 자체가 암호화되지 않았다면 응용 프로그램의 데이터 보호 기능에서 알려진 약점이 악용될 수 있습니다. 디스크 암호화가 적용되어 있으면 이러한 악용은 불가능합니다.

SSE(저장소 서비스 암호화)는 Azure 자체의 일부이며 SSE를 사용할 때 VM 디스크 IO에 현저한 성능 영향이 없어야 합니다. 이제 SSE가 있는 관리 디스크가 기본값이므로 이를 변경할 이유가 없습니다. ADE(Azure Disk Encryption)에서는 VM 운영 체제 도구(BitLocker 및 DM-Crypt)를 사용하므로 VM 디스크에서 암호화 또는 암호 해독이 수행되고 있을 때 VM 자체에서도 특정 작업을 수행해야 합니다. 일반적으로는 특정 상황을 제외하면 이러한 추가 VM CPU 활동으로 인한 영향은 거의 없습니다. 예를 들어 CPU를 많이 사용하는 응용 프로그램이 있다면 성능을 최대화하기 위해 OS 디스크를 암호화되지 않은 상태로 유지할 수 있습니다. 이러한 상황에서는 응용 프로그램 데이터를 별도의 암호화된 데이터 디스크에 저장하면 보안을 그대로 유지하면서 필요한 성능을 달성할 수 있습니다.

Azure에서는 Azure VM 디스크를 보호하는 데 사용되는 두 가지 보조 암호화 기술을 제공합니다. 이러한 기술인 SSE 및 ADE는 여러 계층에서 암호화를 수행하며, 다양한 용도로 사용됩니다. 둘 다 AES 256비트 암호화를 사용합니다. 이 두 기술을 모두 사용하면 Azure 저장소 및 특정 VHD에 대한 무단 액세스를 심층 방어하는 보호 기능이 제공됩니다.
