많은 응용 프로그램 사용을 게시-구독 모델 무슨 일 또는 일부 개체가 변경 된 분산된 구성 요소에 알리기 위해. Azure에서 실행되는 Web API를 사용하는 음악 공유 응용 프로그램이 있다고 가정해 봅시다. 사용자는 새 곡이 업로드 하면 해당 장르에 관심이 전 세계 사용자 장치에 설치 된 모든 모바일 앱에 알리기 위해 필요 합니다.

이 아키텍처에서 사운드 파일의 게시자는 공유 음악 관심이 구독자에 대해 알아야 할 필요 하지 않습니다. 또한이 새 곡을 관심이 지 수도 필요에 따라 여러 구독자 수 있는-일대다 관계가 정의 되어 하고자 합니다. Azure Event Grid는 이러한 유형의 아키텍처에 가장 이상적인 솔루션입니다.

## <a name="what-is-azure-event-grid"></a>Azure Event Grid 란?
Azure Event Grid는 Azure Service Fabric을 기반으로 실행 되는 완전히 관리 되는 이벤트 라우팅 서비스입니다. Event Grid는 배포 _이벤트_ 다른 원본에서 Azure Blob 저장소 계정 또는 Azure Media Services와 같은 Azure Functions 또는 웹 후크 같은 다른 처리기에 있습니다. Event Grid는 Azure를 쉽게 이벤트 기반 빌드 및 서버 리스 응용 프로그램 수 있도록 만들어졌습니다.

Event Grid 게시자 또는 구독자로 대부분의 Azure 서비스를 지원 하며 타사 서비스에 사용 될 수 있습니다. 게시자가 구독자에게 상태 변화를 알릴 수 있는 동적으로 확장 가능하고 저렴한 메시지 시스템을 제공합니다. 다음 그림은 여러 소스에서 메시지를 수신 하 고 구독에 따라 이벤트 처리기를 배포 하는 Azure Event Grid를 보여 줍니다.

구독자에는 원본에 연결 하는 Azure Event Grid의 몇 가지 개념이 있습니다.

1. **이벤트** - 발생한 내용입니다.
1. **이벤트 원본** - 이벤트가 발생한 곳입니다.
1. **토픽** - 게시자가 이벤트를 보낸 엔드포인트입니다.
1. **이벤트 구독** - 때때로 여러 처리기에 이벤트를 라우팅하는 엔드포인트 또는 기본 제공 메커니즘입니다. 구독도 처리기가 지능적으로 들어오는 이벤트를 필터링 할 사용 됩니다.
1. **이벤트 처리기** - 이벤트에 반응하는 앱 또는 서비스입니다.

![여러 이벤트 소스 및 여러 이벤트 처리기 사이 배치 하는 Azure Event Grid를 보여 주는 예시입니다. Event Grid로 이벤트를 전송 하는 이벤트 원본을 Event Grid는 구독자에 게 관련 이벤트를 전달 합니다. Event Grid 토픽을 사용 하 여는 처리기에 보낼 이벤트를 결정 합니다. 이벤트 소스 태그 하나 이상의 항목을 사용 하 여 각 이벤트 및 이벤트 처리기는 관심이 있는 항목을 구독 합니다.](../media-draft/5-event-grid.png)

### <a name="what-is-an-event"></a>이벤트란?
**이벤트** 수행에 무엇을 설명 하는 데이터 메시지가 Event Grid를 통해 전달 합니다. 각 이벤트 독립적 이기 때문에, 최대 64KB 일 수 및 Event Grid에서 정의 된 스키마에 따라 일부 정보가 포함 되어 있습니다.

```json
[
  {
    "topic": string,
    "subject": string,
    "id": string,
    "eventType": string,
    "eventTime": string,
    "data":{
      object-unique-to-each-publisher
    },
    "dataVersion": string,
    "metadataVersion": string
  }
]
```

| 필드 | 설명 |
|-------|-------------|
| **topic** | 이벤트 소스에 대 한 전체 리소스 경로입니다. Event Grid는 이 값을 제공합니다. |
| **subject** | 게시자가 정의한 이벤트 주체에 대한 경로입니다. |
| **id** | 이벤트에 대 한 고유 식별자입니다. |
| **eventType** | 이 이벤트 원본에 대해 등록된 이벤트 유형 중 하나입니다. 값 예를 들어, 필터를 만들 수 있습니다 `CustomerCreated`하십시오 `BlobDeleted`, `HttpRequestReceived`등입니다. |
| **eventTime** | 공급자의 UTC 시간을 기준으로 이벤트가 생성 된 시간입니다. |
| **데이터** | 이벤트의 종류와 관련 된 정보입니다. 예를 들어 Azure Storage에서 만드는 새 파일에 대한 이벤트에는 `lastTimeModified` 값과 같은 파일에 대한 세부 정보가 포함되어 있습니다. 또는 Event Hubs 이벤트는 캡처 파일의 URL을 갖습니다. 이 필드는 선택 사항입니다. |
| **dataVersion** | 데이터 개체의 스키마 버전입니다. 게시자가 스키마 버전을 정의합니다. |
| **metadataVersion** | 이벤트 메타데이터의 스키마 버전입니다. Event Grid는 최상위 속성의 스키마를 정의합니다. Event Grid는 이 값을 제공합니다. |

> [!TIP]
> Event Grid는 발생 했거나 변경 항목을 나타내는 이벤트를 보냅니다. 그러나 합니다 _실제 개체_ 변경 된 이벤트 데이터의 일부가 아닙니다. 대신, URL 또는 식별자를 자주 변경된 된 개체 참조에 전달 됩니다.

### <a name="what-is-an-event-source"></a>이벤트 원본이란?
이벤트 원본은 Event Grid에 이벤트를 보내는 역할을 담당합니다. 각 이벤트 원본은 하나 이상의 이벤트 유형과 관련이 있습니다. 예를 들어 Azure Storage는 이벤트가 생성된 Blob에 대한 이벤트 원본입니다. IoT Hub는 장치에서 만든 이벤트에 대한 이벤트 원본입니다. 응용 프로그램은 사용자가 정의한 사용자 지정 이벤트에 대한 이벤트 원본입니다. 잠시 후에 자세히 이벤트 소스를 살펴 보겠습니다 했습니다.

> [!NOTE]
> 또한 azure 이벤트 허브 이벤트 게시자의 개념을 정의합니다. 이벤트 허브에 게시자에는 사용자 또는 Event Grid로 이벤트를 보내는 결정 하는 조직입니다. 예를 들어, Microsoft는 여러 Azure 서비스에 대 한 이벤트를 게시합니다. 사용자의 자체 응용 프로그램에서 이벤트를 게시할 수 있습니다. Azure 외부 서비스를 호스트하는 조직은 Event Grid를 통해 이벤트를 게시할 수 있습니다. 이 종종 가져옵니다 혼합 된 이벤트 소스입니다. 완벽 하 게 정의 된 이벤트 원본이 게시자와 해당 게시자에 대 한 이벤트를 생성 하는 특정 서비스입니다. 여기에서 사용 하 여 "게시자" 및 "이벤트 원본" 같은 의미로를 이벤트 허브로 메시지를 보내는 엔터티를 나타냅니다.

### <a name="what-is-an-event-topic"></a>이벤트 항목을 란?
이벤트를 그룹으로 분류 하는 이벤트 항목입니다. 항목 공용 끝점으로 표시 되 고 이벤트 소스에서 이벤트를 전송 하는 위치는 _에_입니다. 응용 프로그램을 디자인할 때는 만들려는 토픽 수 하는 방법을 결정할 수 있습니다. 더 큰 솔루션 솔루션이 작을수록를 단일 토픽으로 모든 이벤트를 보낼 수 있지만 각 범주의 관련된 이벤트에 대 한 사용자 지정 토픽을 만듭니다. 사용자 계정을 수정하고 주문을 처리하는 것과 관련된 이벤트를 보내는 응용 프로그램을 예로 들 수 있습니다. 이벤트 처리기가 이벤트의 두 범주 모두를 원할 가능성은 낮습니다. 두 개의 사용자 지정 토픽을 만들고 이벤트 처리기가 관심 있는 토픽에 구독할 수 있도록 합니다. 특정 항목에서 원하는 이벤트 유형에 대 한 이벤트 구독자를 필터링 수 있습니다.

항목으로 나뉩니다 **시스템** 항목 및 **사용자 지정** 항목입니다.

#### <a name="system-topics"></a>시스템 항목
시스템 토픽은 Azure 서비스에서 제공하는 기본 제공 항목입니다. 게시자가 항목을 소유하기 때문에 Azure 구독에는 시스템 항목이 표시되지 않지만 항목을 구독할 수 있습니다. 구독하려면 이벤트로부터 받으려는 리소스에 대한 정보를 제공합니다. 리소스에 액세스할 수 있는,으로 해당 이벤트를 구독할 수 있습니다.

#### <a name="custom-topics"></a>사용자 지정 항목
사용자 지정 토픽은 응용 프로그램 및 타사 토픽입니다. 사용자 지정 항목을 만들거나 사용자 지정 항목에 대한 액세스가 할당되면 구독에 사용자 지정 항목이 표시됩니다.

### <a name="what-is-an-event-subscription"></a>이벤트 구독 이란?
이벤트 구독 토픽에 이벤트를 받으려는 이벤트 처리기를 정의 합니다. 구독 수 있도록 이벤트 처리기 관련 이벤트만 받도록 형식이 나 주체를 사용 하 여 이벤트를 필터링 수도 있습니다.

### <a name="what-is-an-event-handler"></a>이벤트 처리기 란?
이벤트 처리기 (이벤트 "구독자" 라고도 함)는 Event Grid에서 이벤트를 받을 수 있는 모든 구성 요소 (응용 프로그램 또는 리소스). 예를 들어 Blob 저장소 계정에 새 음악이 추가되면 Azure Functions는 그에 대응하여 코드를 실행할 수 있습니다. 구독자는 어떤 이벤트를 처리할 것인지 결정할 수 있고, Event Grid는 새 이벤트를 사용할 수 있게 되면 관심이 있는 각 구독자에게 그 사실을 효율적으로 알리며 폴링은 필요 없습니다.

## <a name="types-of-event-sources"></a>이벤트 원본 형식
이벤트를 생성할 수 있는 Azure 리소스 형식은 다음과 같습니다.

- **Azure 구독 및 리소스 그룹.** 구독 및 리소스 그룹은 Azure에서 관리 작업에 관련된 이벤트를 생성합니다. 예를 들어 사용자가 가상 머신을 만들 때 이 원본은 이벤트를 생성합니다.
- **컨테이너 레지스트리입니다.** Azure Container Registry 서비스 레지스트리에서 이미지 추가, 제거 또는 변경 될 때 이벤트를 생성 합니다.
- **이벤트 허브입니다.** 처리 하 고 다양 한 데이터 원본-일반적으로 로깅 또는 관련 된 원격 분석 이벤트를 저장 합니다. 이벤트 허브를 사용할 수 있습니다. 이벤트 허브는 파일을 캡처할 때 Event Grid로 이벤트를 생성할 수 있습니다.
- **Service Bus.** Service bus는 수신기가 없는 사용 하 여 활성 메시지가 있는 경우 Event Grid로 이벤트를 생성할 수 있습니다.
- **저장소 계정.** Storage 계정은 사용자가 Blob, 파일, 표 항목 또는 큐 메시지를 추가할 때 이벤트를 생성할 수 있습니다. 이벤트 원본으로 blob 계정 및 범용 V2 계정 양쪽 모두를 사용할 수 있습니다.
- **Media Services.** Media Services는 비디오 및 오디오 미디어를 호스트하고 미디어 파일에 대한 고급 관리 기능을 제공합니다. Media Services는 비디오 파일에서 인코딩 작업이 시작되거나 완료될 때 이벤트를 생성할 수 있습니다.
- **Azure IoT Hub.** IoT Hub는 IoT 장치와 통신하고 IoT 장치에서 원격 분석을 수집합니다. 해당 통신이 도착할 때마다 이벤트를 생성할 수 있습니다.
- **사용자 지정 이벤트.** 사용자 지정 이벤트는 REST API 또는 Java, GO, .NET, Node, Python 및 Ruby용 Azure SDK를 사용하여 생성할 수 있습니다. 예를 들어 Azure App Service의 Web Apps 기능에서 사용자 지정 이벤트를 만들 수 있습니다. 이 값은 저장소 큐에서 메시지를 선택 하는 경우 작업자 역할에서 발생할 수 있습니다.

Azure 내에서 다양 한 이벤트 소스를 사용 하 여 긴밀 한 통합이 Event Grid는 거의 모든 Azure 리소스와 관련 된 이벤트를 배포할 수 있다는 것을 확인 합니다.

## <a name="event-handlers"></a>이벤트 처리기
Azure의 다음 개체 형식은 Event Grid에서 이벤트를 수신하고 처리할 수 있습니다.

- **Azure Functions.** Azure 함수는 호스트 가상 서버나 컨테이너 없이 Azure에서 실행되는 사용자 지정 코드로 구성됩니다. 이벤트에 대한 사용자 지정 응답을 코딩하려는 경우 Azure 함수를 이벤트 처리기로 사용합니다.
- **웹후크.** 웹 후크는 푸시 아키텍처를 구현 하는 웹 API입니다.
- **Azure Logic Apps.** Azure 논리 앱은 비즈니스 프로세스를 워크플로로 호스트합니다.
- **Microsoft Flow.** Flow 역시 워크플로를 호스트하지만 비기술 직원이 더욱 쉽게 사용할 수 있습니다.

## <a name="should-you-use-event-grid"></a>Event Grid를 사용해야 하나요?
다음 기능이 필요한 경우 Event Grid를 사용합니다.

- **단순성.** 원본 Event Grid의 구독자에 연결 하는 것이 간단 합니다.
- **고급 필터링.** 구독은 토픽에서 수신하는 이벤트를 엄격하게 제어합니다.
- **팬아웃.** 개수에 제한 없이 동일한 이벤트 및 항목에는 끝점을 구독할 수 있습니다.
- **안정성.** Event Grid는 최대 24시간 동안 각 구독에 대한 이벤트 전송을 다시 시도합니다.
- **이벤트별 요금.** 전송하는 이벤트 수에 대한 요금만 지급합니다.

## <a name="summary"></a>요약
Event Grid는 단순하지만 유연한 이벤트 배포 시스템입니다. Event Grid를 사용하여 구독자에게 별도의 이벤트를 전송하면 구독자가 해당 이벤트를 안정적이고 신속하게 수신할 수 있습니다. 살펴볼 메시지 모델이 하나 더 있습니다. 대규모 이벤트 _스트림_을 전송하려면 어떻게 해야 할까요? Event Grid는 한 번에 한 이벤트를 전송하도록 설계되었기 때문에 이 시나리오에는 적합하지 않습니다. 그 대신 다른 Azure 서비스인 Event Hubs가 필요합니다.