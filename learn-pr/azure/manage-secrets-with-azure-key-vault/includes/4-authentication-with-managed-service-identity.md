Azure Key Vault는 **Azure Active Directory**를 사용하여 자격 증명 모음에 액세스하려는 사용자 및 응용 프로그램을 인증합니다. 자격 증명 모음에 대한 액세스 권한을 웹 응용 프로그램에 부여하려면 먼저 Azure Active Directory에 앱을 등록해야 합니다. 등록하면 앱에 대한 ID가 생성됩니다. ID가 생성되고 나면 자격 증명 모음 권한을 이 ID에 할당할 수 있습니다.

앱 및 사용자는 Azure Active Directory 인증 토큰을 사용하여 Key Vault에 인증됩니다. 토큰을 가진 임의의 사용자가 응용 프로그램 ID를 사용해 자격 증명 모음의 모든 비밀에 액세스할 수 있기 때문에, Azure Active Directory에서 토큰을 가져오려면 비밀 또는 인증서가 필요합니다.

응용 프로그램 비밀은 자격 증명 모음에 안전하게 보관되지만, 이 비밀에 액세스하려면 자격 증명 모음 외부에 비밀 또는 인증서를 유지해야 합니다. 이 문제를 ‘부트스트랩 문제’라고 하며, Azure에는 이에 대한 해결책이 있습니다.

## <a name="managed-service-identity"></a>관리되는 서비스 ID

MSI(관리 서비스 ID)는 비밀을 하나도 관리하지 않고도 앱이 Key Vault 및 다른 Azure 서비스에 액세스하는 데 사용할 수 있는 Azure App Service의 기능입니다. MSI를 사용하는 것은 비밀을 직접 관리하는 것보다 더 단순하고 안전합니다.

MSI를 사용하면 Azure는 앱에서 사용할 특정 용도로 별도의 토큰 부여 REST 서비스를 활성화합니다. 앱이 MSI 토큰 서비스에 토큰을 요청하면, 이 서비스는 Azure Active Directory에 연결해 MSI ID의 토큰을 가져오고 이를 Key Vault에 사용할 수 있도록 다시 앱에 전달합니다. 이 워크플로의 가장 중요한 부분은 앱이 MSI 토큰 서비스에 인증되는 방식입니다. 즉, 구성에서 관리해야 하는 비밀이나 인증서를 요구하는 대신, 앱에서는 Azure가 시작될 때 환경 변수에 안전하게 주입한 비밀을 사용합니다. 이 비밀 값을 관리하거나 어딘가에 저장할 필요가 없습니다. 앱 외부의 어떤 것도 이 비밀 또는 MSI 토큰 서비스 엔드포인트에 액세스할 수 없습니다.

또한 MSI는 Azure Active Directory에 앱을 등록합니다. MSI를 사용하지 않도록 설정하거나 앱을 삭제하는 경우, MSI는 이 등록을 삭제합니다.

MSI는 Azure 구독에 포함된 체험 버전을 비롯하여 모든 버전의 Azure Active Directory에서 사용할 수 있습니다. App Service에서 MSI를 사용하는 경우 추가 비용이 없고 구성이 필요 없으며 언제든지 앱에서 사용하거나 사용 중지할 수 있습니다.

> [!NOTE]
> MSI는 현재 Linux 또는 컨테이너 웹앱에 대해 지원되지 않습니다.

MSI를 사용하려면 구성 없이 단일 Azure CLI 명령만 있으면 됩니다. 5단원에서 App Service 앱을 설정하고 Azure에 배포할 때 수행하겠습니다. 하지만 그전에 MSI에 대한 지식을 적용하여 앱의 코드를 쓰겠습니다.