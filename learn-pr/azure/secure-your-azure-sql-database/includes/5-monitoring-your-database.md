네트워크에서 잠재적 보안 위반을 감지 된 회사의 보안 관리자에서 경고를 수신 한다고 가정 합니다. 데이터베이스 서버를 보호 하기 위해 감사 및 모니터링을 추가 하기로 합니다.

이 단위에 데이터베이스에 대해 감사를 구성 하는 방법 및 이러한 감사를 사용 하는 방법에 살펴봅니다.

## <a name="configure-auditing"></a>감사 구성

감사 이상 검사를 위해 데이터베이스에서 발생 하는 작업 저장소를 사용 하 게 또는 자동화 된 도구 분석 합니다. 감사 데이터베이스에 사용 되는 방법을 이해 규정 준수 관리에도 사용 됩니다. 감사는 Azure SQL database에서 Azure 위협 감지를 사용 하려는 경우 필요 합니다.

데이터베이스의 감사를 저장 하기 위해 Azure 저장소 계정 감사 기록을 저장 하기 위한 필요 합니다.

시스템에서 감사를 설정 하는 단계를 살펴보겠습니다.

1. 포털에서 Azure SQL Server를 선택 합니다.

2. 왼쪽된 구성 옵션에서 감사 항목으로 이동 합니다. 보안 범주에서 찾게 됩니다.

3. 감사는 기본적으로 해제 되어 있습니다. 데이터베이스 서버에서 사용 하려면 ON 단추를 누릅니다.

4. ON 단추를 선택 하면 저장소 계정을 정의 하려면 구성 단추를 선택 합니다. 기존 저장소 계정을 선택 하거나에 감사를 저장할 수 있는 새 저장소 계정을 만들 수 있습니다. 저장소 계정은 동일한 지역에 서버로 사용 하도록 구성 되어야 합니다.

5. 변경 내용을 저장 하려면 도구 모음에서 '저장' 단추를 클릭 합니다.

이러한 작업을 데이터베이스 서버 수준 감사를 구성합니다. 데이터베이스 수준에서 감사를 구성할 수도 있습니다.

이제 Advanced Threat Protection을 구성할 수 있습니다.

## <a name="configure-advanced-threat-protection"></a>Advanced Threat Protection 구성

Advanced Threat Protection 시스템은 잠재적인 문제 및 데이터베이스에 대 한 위협을 검색할 감사 로그를 분석 합니다.

시스템에서 Advanced Threat Protection을 구성 하는 단계를 살펴보겠습니다.

1. 포털에서 Azure SQL Server를 선택 합니다.

2. 왼쪽된 구성 옵션의 Advanced Threat Protection 항목으로 이동 합니다. 보안 범주에서 찾을 수 있습니다.

3. ' 사용 Advanced Threat Protection 서버에서 ' 단추를 클릭 합니다.

4. Advanced Threat Protection 스위치를 ON으로 변경 합니다.

5. 데이터베이스 시스템에 대 한 옵션을 보려면 보기 Advanced Threat Protection 서버 설정을 선택 합니다.

6. 다음으로 알림 전자 메일 목록을 세미콜론으로 배달할 전자 메일 주소를 구분 하는 위치를 정의 합니다. 전자 메일 서비스 및 서비스 관리자에 대 한 위협을 보낼 공동 관리자를 선택 합니다.

7. 이제 구독 및 저장소 계정에 시스템에 대 한 모든 위험에 대 한 분석 됩니다 지정 합니다. 이 구독 및 Azure storage를 해야 감사을 위해 계정을 구성 합니다. 감사 기록을 보존할 일 수를 설정 해야 합니다. 0으로 감사 영구적으로 저장 되는 값을 설정 합니다.

다음으로, 감사에 연결할 저장소 액세스 키를 선택 합니다. 옵션을 구성한 후 확인을 누릅니다.

마지막으로, 위협 요소 탐지 형식을 설정 합니다. 기본 옵션이 까지입니다.

모든 값을 나타냅니다.

- 여기서 SQL 삽입 공격 발생 한 SQL 주입 보고서
- SQL 주입 취약점으로 인 한 보고서는 SQL 삽입 공격의 가능성 가능성이; 및
- 비정상적인 클라이언트 로그인 일반 하지 않으며 잠재적 공격자가 얻는 액세스와 같은 문제가 원인일 수 있는 로그인에 살펴봅니다.

클릭 합니다 **저장** 변경 내용을 적용 하려면 단추입니다.

취약성 감지 되 면 전자 메일 알림을 받게 됩니다. 전자 메일에는 발생 한 상황 및 수행할 작업을 간략하게 설명 합니다.

## <a name="enable-advanced-threat-protection"></a>Advanced Threat Protection을 사용 하도록 설정

Advanced Threat Protection에 대 한 서버를 구성한 후 각 개별 데이터베이스에서 옵션을 사용 하도록 설정 합니다. 개별 데이터베이스를 이동한 후 ' 사용 Advanced Threat Protection 서버에서 '를 선택 하 여 Advanced Threat Protection을 사용 하도록 설정 합니다.

주기적 되풀이 검색을 검색 하는 시스템 7 일 마다 취약점으로 인 한 검색할를 켤 수 있습니다.

주기적 되풀이 검색 옵션을 선택 하면 검색 설정을 저장 한 후 바로 실행 됩니다.

**저장** 단추를 클릭하여 변경 내용을 저장합니다.

모든 보안 문제를 알리는 전자 메일 알림을 받게 됩니다. 즉시 한 위협을 해결 해야 합니다. 다양 한 이유로 대 한 알림이 표시 될 수 있습니다.

![Advanced Threat Protection에서 예제 알림 경고를](../media-draft/5-email-with-warning.png)

Advanced Threat Protection이 실행 중일 때 Advanced Threat Protection 옵션을 선택 하면를 설명 하는 문제 목록이 표시 됩니다. 이 목록에는 데이터 검색 및 중요 한 데이터와 같은 분류 문제, 시스템에 잠재적 위협 취약성 목록이 포함할 수 있습니다.

![데이터 검색 및 분류](../media-draft/5-data-discovery-and-classification.png)

데이터 검색 및 분류 패널을 보호 해야 하는 테이블 내의 열을 보여 줍니다. 열의 일부 중요 한 정보가 있을 수 있습니다 또는 다른 국가 또는 지역에서 분류 간주 됩니다.

데이터 검색 및 분류 패널을 클릭 합니다.

열 구성 된 보호 해야 하는 경우 메시지가 표시 됩니다. 이 메시지의 형태로 됩니다 *"10 열을 발견 했습니다 분류 권장 사항이 있는"* 합니다. 권장 사항을 보려면 텍스트를 클릭할 수 있습니다.

열 옆에 있는 확인 표시를 클릭 하 여 분류 하려는 열을 선택 하거나 스키마 머리글 왼쪽에 있는 확인란을 선택 합니다. 분류 권장 사항을 적용 하 Accept 선택한 권장 사항 옵션을 선택 합니다.

열을 편집 하 고 정보 형식 및 데이터베이스에 대 한 민감도 레이블을 정의 합니다. 변경 내용을 저장 하려면 저장 단추를 클릭 합니다.

활성 권장 사항 없음 권장 사항을 성공적으로 관리 한 후 나열 되어야 합니다.

![취약성 평가 대시보드](../media-draft/5-vulnerability-assessment-dashboard.png)

취약성 평가 하 여 데이터베이스 및 관련된 위험 구성 문제를 나열합니다. 예를 들어 위의 이미지에서 서버 수준 방화벽 설정 해야 하는 경우 볼 수 있습니다.

취약성 평가 패널의 취약점으로 인 한 전체 목록을 검토 하려면 여기를 클릭 합니다. 여기에서 각 개별 취약점으로 인 한을 클릭할 수 있습니다.

해당 페이지의 위험 수준, 취약점 및 문제 해결을 위해 권장된 된 수정을 설명은를 적용 하는 데이터베이스와 같은 세부 정보가 표시 됩니다. 문제 또는 문제를 해결 하려면 업데이트 관리를 적용 합니다. 모든 취약성을 해결 해야 합니다.

![위협 감지](../media-draft/5-threat-detection-dashboard.png)

마지막 차트에는 위협 검색의 목록을 표시합니다. 예를 들어,이 목록에 잠재적인 SQL 삽입 공격 수가 표시 됩니다.

취약점으로 인 한, 같은 패널을 클릭 위협 검색 기능을 보러 위협 항목의 목록으로 이동 합니다. 권장 사항에 따라 해당 문제를 해결 합니다.  SQL 삽입 경고와 같은 문제에 대 한 쿼리를 살펴보고 작업을 쿼리 하는 코드에서 실행 되는 수 있습니다. 일단 찾았으면 없습니다에서는 코드를 다시 작성 문제를 더 이상 됩니다 있도록 합니다.
