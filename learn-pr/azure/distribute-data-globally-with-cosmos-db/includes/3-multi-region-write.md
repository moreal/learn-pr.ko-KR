여기에 나온 전자상거래 시나리오에서 훌륭한 사용자 환경을 구현하려면 가용성이 높고 대기 시간이 짧아야 합니다.

방금 만든 Azure Cosmos DB 계정에 다중 마스터 지원을 활성화하면 성능 측면에서 여러 가지 이점이 있으며, 모든 이점은 Azure Cosmos DB에서 제공하며, 경제적으로 지원되는 SLA(서비스 수준 계약)로 보장됩니다.

## <a name="what-is-multi-master-support"></a>다중 마스터 지원이란 무엇인가요?

다중 마스터 지원이란 새 Azure Cosmos DB 계정에서 사용할 수 있는 옵션입니다. 계정이 여러 지역에 복제되면 각 지역은 원하는 위치에 쓰기 모델에 동등하게 참여하는 마스터 지역이 되며, 이를 활성-활성 패턴이라고도 합니다.

다중 마스터 구성에서 마스터 영역으로 작동하는 Azure Cosmos DB 영역은 자동으로 모든 복제본에 기록되는 데이터를 수렴하고 글로벌 일관성 및 데이터 무결성을 보장하도록 작동합니다.

Azure Cosmos DB 다중 마스터 지원을 통해 전 세계에서 쓰기 가능한 지역의 모든 컨테이너에 쓰기를 수행할 수 있습니다. 작성된 데이터는 다른 모든 영역에 즉시 전파됩니다.  

## <a name="what-are-the-benefits-of-multi-master-support"></a>다중 마스터 지원의 이점은 무엇인가요?

다중 마스터 지원의 이점은 다음과 같습니다.

* 쓰기 대기 시간 한 자릿수  – 다중 마스터 계정은 99%의 쓰기 작업에서 대기 시간이 10ms 미만으로 단축되었습니다(비다중 마스터 계정의 대기 시간은 최대 15ms 미만).
* 읽기-쓰기 가용성 99.999% - 다중 마스터 계정의 쓰기 가용성이 99.999%로 증가했습니다(비다중 마스터 계정의 쓰기 가용성은 최대 99.99%).
* 무제한 쓰기 확장성 및 처리량  – 다중 마스터 계정을 사용하면 모든 지역에 쓸 수 있어 무제한 쓰기 확장성 및 처리량이 지원되고, 수십억 개의 장치가 지원됩니다.
* 충돌 해결 기능 기본 제공 – 다중 마스터 계정은 글로벌 데이터 무결성 및 일관성을 보장하기 위해 세 가지 충돌 해결 방법을 지원합니다. 

## <a name="conflict-resolution"></a>충돌 해결

다중 마스터 지원을 추가하면 여러 지역에 대한 쓰기가 충돌할 가능성이 있습니다. 충돌은 Azure Cosmos DB에서 매우 드물게 나타나며, 지역 간에 전파가 발생하기 전에 여러 지역에서 한 항목이 동시에 변경될 경우에만 발생할 수 있습니다. 복제가 전역적으로 수행될 때의 속도로 볼 때, 이러한 상황은 자주 겪지 않는 것이 좋습니다. 그러나 Azure Cosmos DB는 두 개 이상의 지역에서 서로 다른 작성자가 동일한 레코드를 동시에 업데이트하는 경우 사용자가 문제를 해결하는 방법을 결정할 수 있는 충돌 해결 모드를 제공합니다.  

Azure Cosmos DB에서 제공하는 3가지 유형의 충돌 해결 모드가 있습니다. 
* **마지막 작성자 우선(LWW)**: 문서의 사용자 정의 정수 속성 값에 따라 충돌이 해결됩니다. 기본적으로 _ts는 마지막으로 작성된 문서를 확인하는 데 사용됩니다. 마지막 작성자 우선은 기본 충돌 처리 메커니즘입니다.
* **사용자 지정 - 사용자 정의 프로시저**: 컬렉션에 사용자 정의 프로시저를 등록하여 충돌 해결을 완전히 제어할 수 있습니다. 사용자 정의 프로시저는 매우 구체적인 서명을 사용하는 특수한 유형의 저장 프로시저입니다. 사용자 정의 프로시저가 실패하거나 없는 경우, Azure Cosmos DB는 모든 충돌을 읽기 전용 충돌 피드에 추가하여 비동기적으로 처리될 수 있도록 합니다.  
* **사용자 지정 - 비동기**: Azure Cosmos DB가 모든 충돌을 커밋 대상에서 제외하고, 읽기 전용 충돌 피드에 등록하여 사용자의 응용 프로그램에서 나중에 해결하도록 합니다. 응용 프로그램이 충돌 해결을 비동기적으로 수행할 수 있으며, 논리를 사용하거나 외부 소스, 응용 프로그램 또는 서비스를 참조하여 충돌을 해결할 수 있습니다.

## <a name="summary"></a>요약

이 단원에서는 여러 지역에 데이터를 작성하여 가용성과 성능을 높일 수 있는 다중 마스터 계정에 대해 알아보았습니다.