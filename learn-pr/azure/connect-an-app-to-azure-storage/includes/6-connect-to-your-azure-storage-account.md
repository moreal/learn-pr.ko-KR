필요한 클라이언트 라이브러리를 응용 프로그램에 추가하고 Azure Storage 계정에 연결할 준비가 되었습니다. 하지만 앱이 연결할 계정과 해당 저장소 계정이 있는 지역을 아는 방법은 무엇인가요? 적절한 구성이 없는 경우 앱이 Azure Storage 계정에 연결하는 방법을 알지 못합니다. 

여기서는 저장소 계정 연결 정보를 Azure Portal에서 찾아 응용 프로그램 구성에 배치하여 앱이 Azure Storage 계정에 연결할 준비가 되도록 합니다.

## <a name="access-keys"></a>액세스 키

각 저장소 계정에는 저장소 계정에 액세스하는 것을 허용하는 액세스 키 집합이 있습니다. 앱이 여러 저장소 계정에 연결해야 하는 경우 앱은 저장소 계정마다 액세스 키가 필요합니다.

![여러 계정](..\media-draft\7-multiple-accounts.png)

Azure는 클라우드 공급자이므로 앱은 저장소 계정에 인증하기 위한 액세스 키 외에도 인터넷을 통해 저장소 계정에 대한 액세스를 제공하는 저장소 서비스 엔드포인트를 알고 있어야 합니다. 이 정보를 처리하는 가장 간단한 방법은 단일 문자열에 모든 필요한 모든 연결 정보가 포함된 저장소 계정 연결 문자열을 사용하는 것입니다.

Azure Storage 연결 문자열은 아래 예제와 비슷하지만 특정 저장소 계정의 액세스 키 및 계정 이름이 포함되어 있습니다.

```csharp
DefaultEndpointsProtocol=https;AccountName={your-storage};AccountKey={your-access-key};EndpointSuffix=core.windows.net
```

## <a name="security"></a>보안

액세스 키는 저장소 계정에 대한 액세스를 제공하는 데 중요하므로 사용자 저장소 계정에 액세스하지 않게 하려는 시스템 또는 개인에게 제공해서는 안 됩니다. 액세스 키는 사용자의 컴퓨터에 액세스하기 위한 사용자 이름 및 암호와 같습니다.

![자격 증명 모음의 키](..\media-draft\8-keys-vault.png)

일반적으로 저장소 계정 연결 정보는 환경 변수, 데이터베이스 또는 구성 파일에 저장됩니다.

소스 제어에 해당 파일을 포함하고 공용 리포지토리에 저장하는 경우 이 정보를 구성 파일에 저장하는 것이 위험할 수도 있습니다. 이는 일반적인 실수이며 사용자가 공용 리포지토리에서 소스 코드를 찾아보고 저장소 계정 연결 정보를 볼 수 있다는 것을 의미합니다.

저장소 계정은 제한된 액세스 권한을 부여해야 하는 시나리오에 대한 만료와 제한된 권한을 지원하는 공유 액세스 서명이라는 별도의 인증 메커니즘을 제공합니다. 이 항목은 여기서 다루지 않으며 이 모듈에 필요한 지식도 아닙니다. 자세한 내용은 [여기](https://docs.microsoft.com/en-us/azure/storage/common/storage-dotnet-shared-access-signature-part-1)서 확인할 수 있습니다.

각 저장소 계정에는 두 개의 액세스 키가 있습니다. 두 개인 이유는 저장소 계정의 보안을 유지하기 위한 보안 모범 사례의 일환으로 주기적으로 키를 회전(다시 생성)하도록 허용하기 위해서입니다. 이 프로세스는 Azure Portal 또는 CLI에서 수행할 수 있습니다.

키를 회전하면 원래 키 값이 즉시 무효화되며 부적절하게 키를 얻은 모든 사용자의 액세스 권한이 철회됩니다. 두 개의 키가 지원되므로 이러한 키를 사용하는 응용 프로그램에 가동 중지 시간을 일으키지 않고 키를 회전할 수 있습니다. 앱이 대체 액세스 키를 사용하도록 전환할 수 있으며 다른 키 하나는 다시 생성됩니다. 이 저장소 계정을 사용하는 앱이 여러 개인 경우 이 기술을 지원하려면 해당 앱 모두 동일한 키를 사용해야 합니다. 자세한 내용은 [여기](https://docs.microsoft.com/en-us/azure/storage/common/storage-create-storage-account#manage-your-storage-access-keys)를 참조하세요.

## <a name="advanced-security-options"></a>고급 보안 옵션

Azure는 액세스 키, 암호 또는 인증서 같은 모든 형태의 비밀을 안전하게 저장하도록 설계된 Azure Key Vault라는 고급 보안 저장소를 제공합니다. 이 기능을 사용하면 안전하게 액세스 키를 저장하고 액세스 키가 자동으로 회전되도록 할 수 있습니다.

이 기능은 이 모듈의 범위를 벗어나며 자세한 내용은 [여기](https://docs.microsoft.com/en-us/azure/key-vault/key-vault-ovw-storage-keys)에서 확인할 수 있습니다.

## <a name="summary"></a>요약

Azure Storage 계정에 연결하려면 두 가지가 있어야 합니다. 액세스 키는 사용자 이름 및 암호와 비슷하며 기밀로 유지되어야 합니다. 연결 문자열로 표시되는 저장소 서비스 엔드포인트도 있어야 합니다.

