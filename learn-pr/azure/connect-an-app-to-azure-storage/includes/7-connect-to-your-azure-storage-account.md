필요한 클라이언트 라이브러리를 응용 프로그램에 추가했고 Azure 저장소 계정에 연결할 준비가 되었습니다.

저장소 계정의 데이터를 사용하려면 앱에 두 개의 데이터 조각이 필요합니다.

1. [액세스 키](#access-key)
1. [REST API 엔드포인트](#rest-endpoint)

<a name="access-key"></a>

## <a name="security-access-keys"></a>보안 액세스 키

각 저장소 계정에는 저장소 계정을 보호하는 데 사용되는 두 개의 고유한 _액세스 키_가 있습니다. 앱이 여러 저장소 계정에 연결해야 하는 경우 앱은 저장소 계정마다 액세스 키가 필요합니다.

![클라우드에서 두 개의 저장소 계정에 연결된 응용 프로그램을 보여주는 일러스트레이션. 각 저장소 계정은 고유 키를 사용하여 액세스할 수 있습니다.](..\media\6-multiple-accounts.png)

<a name="rest-endpoint"></a>

## <a name="rest-api-endpoint"></a>REST API 엔드포인트

저장소 계정에 인증하기 위한 액세스 키 외에도, REST 요청을 발급하기 위한 저장소 서비스 엔드포인트를 앱에서 알고 있어야 합니다. 

REST 엔드포인트는 저장소 계정 _이름_, 데이터 형식, 알려진 도메인의 조합으로 구성됩니다. 예:

| 데이터 형식 | 예제 엔드포인트 |
|-----------|------------------|
| Blob     | `https://[name].blob.core.windows.net/` |
| 큐    | `https://[name].queue.core.windows.net/` |
| 테이블     | `https://[name].table.core.windows.net/` |
| 파일     | `https://[name].file.core.windows.net/` |

Azure에 연결된 사용자 지정 도메인이 있는 경우 엔드포인트에 대한 사용자 지정 도메인 URL을 만들 수 있습니다.

## <a name="connection-strings"></a>연결 문자열

이 정보를 처리하는 가장 간단한 방법은 **저장소 계정 연결 문자열**을 사용하는 것입니다. 연결 문자열은 필요한 모든 연결 정보를 단일 텍스트 문자열에 제공합니다.

Azure Storage 연결 문자열은 아래 예제와 비슷하지만 특정 저장소 계정의 액세스 키 및 계정 이름이 포함됩니다.

```
DefaultEndpointsProtocol=https;AccountName={your-storage};
   AccountKey={your-access-key};
   EndpointSuffix=core.windows.net
```

## <a name="security"></a>보안

액세스 키는 저장소 계정에 대한 액세스를 제공하는 데 중요하므로 사용자 저장소 계정에 액세스하지 않게 하려는 시스템 또는 개인에게 제공해서는 안 됩니다. 액세스 키는 사용자의 컴퓨터에 액세스하기 위한 사용자 이름 및 암호와 같습니다.

일반적으로 저장소 계정 연결 정보는 환경 변수, 데이터베이스 또는 구성 파일에 저장됩니다.

> [!IMPORTANT]
> 소스 제어에 해당 파일을 포함하고 공용 리포지토리에 저장하는 경우 이 정보를 구성 파일에 저장하는 것이 위험할 수 있습니다. 이는 일반적인 실수이며 사용자가 공용 리포지토리에서 소스 코드를 찾아보고 저장소 계정 연결 정보를 볼 수 있다는 것을 의미합니다.

각 저장소 계정에는 두 개의 액세스 키가 있습니다. 두 개인 이유는 저장소 계정의 보안을 유지하기 위한 보안 모범 사례의 일환으로 주기적으로 키를 순환(다시 생성)하도록 허용하기 위함입니다. 이 프로세스는 Azure Portal 또는 Azure CLI/PowerShell 명령줄 도구에서 수행할 수 있습니다.

키를 순환하면 원래 키 값이 즉시 무효화되며 부적절하게 키를 얻은 모든 사용자의 액세스 권한이 철회됩니다. 두 개의 키가 지원되므로 이러한 키를 사용하는 응용 프로그램에 가동 중지 시간을 일으키지 않고 키를 회전할 수 있습니다. 앱이 대체 액세스 키를 사용하도록 전환할 수 있으며 다른 키 하나는 다시 생성됩니다. 이 저장소 계정을 사용하는 앱이 여러 개인 경우 이 기술을 지원하려면 해당 앱 모두 동일한 키를 사용해야 합니다. 기본적인 개념은 다음과 같습니다.

1. 저장소 계정의 보조 액세스 키를 참조하도록 응용 프로그램 코드의 연결 문자열을 업데이트합니다.
2. Azure Portal 또는 명령줄 도구를 사용하여 저장소 계정의 기본 액세스 키를 다시 생성합니다.
3. 새 기본 액세스 키를 참조하도록 코드의 연결 문자열을 업데이트합니다.
4. 같은 방식으로 보조 액세스 키를 다시 생성합니다.

> [!TIP]
> 액세스 키의 보안을 유지할 수 있도록 암호를 변경하듯이 액세스 키를 주기적으로 순환할 것을 강력하게 권장합니다. 키를 서버 응용 프로그램에 사용하는 경우 **Azure Key Vault**를 사용하여 자동으로 액세스 키를 저장할 수 있습니다. Key Vault는 저장소 계정과 직접 동기화하고 자동으로 키를 주기적으로 순환하는 기능을 지원합니다. Key Vault를 사용하면 앱이 액세스 키를 직접 작업할 필요가 없는 추가 보안 레이어가 제공됩니다.

### <a name="shared-access-signatures-sas"></a>SAS(공유 액세스 서명)

액세스 키는 저장소 계정에 대한 액세스를 인증하는 가장 쉬운 방법이지만, 컴퓨터의 루트 암호처럼 저장소 계정에 있는 모든 항목에 대한 전체 액세스를 제공합니다. 

저장소 계정은 제한된 액세스 권한을 부여해야 하는 시나리오에 대한 만료 및 제한된 권한을 지원하는 _공유 액세스 서명_이라는 별도의 인증 메커니즘을 제공합니다. 다른 사용자가 데이터를 읽고 저장소 계정에 쓸 수 있게 허용하려면 이 방법을 사용해야 합니다. 이 모듈의 마지막 부분에 이 고급 토픽과 관련된 설명서 링크가 있습니다.
