첫 번째 단계는 클라우드에서 온-프레미스 구성을 다시 만들려면 가능성이 됩니다.

이 기본 구성의 네트워크 구성 방법 및 Azure에서 들어오고 나가는 네트워크 트래픽을 이동 하는 방법을 제공 합니다.

## <a name="your-e-commerce-site-at-a-glance"></a>전자상거래 사이트 개요

대규모 엔터프라이즈 시스템 상호 연결 된 응용 프로그램과 함께 작동 하는 서비스를 여러 종종 구성 됩니다. 인벤토리 표시를 사용 하 고 고객의 주문을 만드는 허용 하는 프런트 엔드 웹 시스템이 있을 수 있습니다. 다양 한 사용자 프로필, 프로세스 신용 카드 및 처리 된 주문 요청 처리를 관리, 인벤토리 데이터를 제공 하려면 웹 서비스와 통신할 수 있습니다.

일부의 전략와 이러한 복잡 한 시스템을 디자인, 빌드, 관리 및 유지 관리를 쉽게 수행할 수 있도록 소프트웨어 설계자와 디자이너에서 사용 하는 패턴입니다. 부터 몇 가지를 살펴보겠습니다 _아키텍처를 느슨하게 결합_합니다.

### <a name="benefits-of-a-loosely-coupled-architecture"></a>느슨하게 결합 된 아키텍처의 이점

> [!VIDEO https://www.microsoft.com/videoplayer/embed/RE2yHrc]

### <a name="using-an-n-tier-architecture"></a>N 계층 아키텍처를 사용 하 여

느슨하게 결합 된 시스템을 구축 하는 아키텍처 패턴은 _다계층_합니다.

[N 계층 아키텍처](https://docs.microsoft.com/azure/architecture/guide/architecture-styles/n-tier) 응용 프로그램 두 개 이상의 논리적 계층을 나눕니다. 아키텍처 측면에서 더 높은 계층에서 낮은 계층으로 서비스에 액세스할 수 있지만 더 낮은 계층 더 높은 계층 액세스 해서는 안 합니다.

계층 문제를 구분 하는 데 도움이 및는 이상적으로 재사용 가능 하도록 설계 되었습니다. 유지 관리를 간소화도 계층화 된 아키텍처를 사용 합니다. 계층 업데이트 하거나 독립적으로 대체할 수 있으며 필요한 경우 새 계층을 삽입할 수 있습니다.

_3계층_은 3개의 계층이 있는 N 계층 응용 프로그램을 말합니다. 전자상거래 웹 응용 프로그램은 이러한 3계층 아키텍처를 따릅니다.

* 합니다 **웹 계층** 브라우저를 통해 사용자에 게 웹 인터페이스를 제공 합니다.
* 합니다 **응용 프로그램 계층** 비즈니스 논리를 실행 합니다.
* 합니다 **데이터 계층** 데이터베이스 및 제품 정보 및 고객이 주문을 포함 하는 다른 저장소를 포함 합니다.

다음 그림에서는 데이터 계층에 사용자 로부터 요청 흐름을 보여줍니다.

![각 계층 전용된 가상 컴퓨터에서 호스트 되는 3 계층 아키텍처를 보여 주는 예시입니다.](../media/2-three-tier.png)

사용자가 단추를 클릭하여 주문을 접수하면 사용자의 주소 및 결제 정보와 함께 웹 계층으로 요청이 전송됩니다. 웹 계층은 응용 프로그램 계층에 이 정보를 전달하고, 응용 프로그램 계층은 결제 정보의 유효성을 검사하고 인벤토리를 확인합니다. 응용 프로그램 계층 순서 선택 하도록 나중에 행에 대 한 데이터 계층에 저장할 수 있습니다.

## <a name="your-e-commerce-site-running-on-azure"></a>Azure에서 실행 중인 전자상거래 사이트

Azure는 다양 한 방법으로 코드를 구성 하는 가상 컴퓨터를 호스트 하는 완벽 하 게 미리 구성 된 환경에서 웹 응용 프로그램을 호스트 하는 사용자 지정 및 관리를 제공 합니다.

가상 머신에서 전자 상거래 사이트를 실행하려는 경우를 가정해 보겠습니다. Azure에서 실행 중인 테스트 환경의 모습은 다음과 같습니다. 다음 그림에서는 인바운드 요청을 제한 하려면 사용 하도록 설정 하는 보안 기능을 사용 하 여 가상 머신에서 실행 되는 3 계층 아키텍처를 보여 줍니다. 

![각 계층을 별도 가상 머신에서 실행 되 고 있는 3 계층 아키텍처를 보여 주는 예시입니다. 각 가상 컴퓨터는 해당 IP 주소를 사용 하 여 레이블이 지정 된 이며 자체 가상 네트워크 내에서. 각 가상 네트워크에 열려 있는 포트를 나열 하는 네트워크 보안 그룹을 있습니다.](../media/2-test-deployment.png)

이를 분석해 보겠습니다.

### <a name="what-is-an-azure-region"></a>Azure 지역이란?

_지역_이란 특정 지리적 위치 내에 있는 Azure 데이터 센터입니다. 미국 동부, 미국 서부, 북유럽이 그 예입니다. 응용 프로그램이 미국 동부 지역에서 실행되고 있는 것이 표시됩니다.

### <a name="what-is-a-virtual-network"></a>가상 네트워크란?

_가상 네트워크_란 Azure에서 논리적으로 격리된 네트워크입니다. Hyper-V, VMware 또는 기타 공용 클라우드에서 네트워크를 설정해 보았다면 Azure 가상 네트워크가 익숙할 것입니다.

웹, 응용 프로그램 및 데이터 계층에는 각각 단일 VM이 있습니다. 각 VM은 가상 네트워크에 속해 있습니다.

사용자는 웹 계층과 직접 상호 작용하므로 VM에는 공용 IP 주소가 있습니다. 사용자는 응용 프로그램 또는 데이터 계층과 상호 작용하지 않습니다. 따라서 이러한 VM에는 각각 비공개 IP 주소가 있습니다.

Azure 데이터 센터는 물리적 하드웨어를 자동으로 관리합니다. 사용자는 소프트웨어를 통해 가상 네트워크를 구성하여 가상 네트워크를 자신의 네트워크처럼 취급할 수 있습니다. 예를 들어 가상 네트워크를 여러 개의 서브넷으로 나누어 네트워크의 IP 주소 할당 방식을 더 효율적으로 제어할 수 있습니다. 또한 공용 인터넷 또는 개인 IP 주소 공간에서 다른 네트워크를 인지 하는 가상 네트워크에 연결할 수 있는 다른 네트워크를 선택 합니다.

### <a name="whats-a-network-security-group"></a>네트워크 보안 그룹이란?

_네트워크 보안 그룹_, 즉 NSG는 Azure 리소스에 대한 인바운드 네트워크 트래픽을 허용하거나 거부합니다. 네트워크 보안 그룹은 네트워크의 클라우드 수준 방화벽으로 간주하세요.

예를 들어 웹 계층의 VM은 포트 22(SSH) 및 80(HTTP)의 인바운드 트래픽을 허용합니다. 여기에 있는 각 네트워크 보안 그룹은 모든 소스에서 들어오는 트래픽을 허용합니다. 신뢰할 수 있는 IP 주소 등 알려진 소스에서 들어오는 트래픽만 허용하도록 네트워크 보안 그룹을 구성할 수 있습니다.

> [!NOTE]
> 포트 22를 사용하면 SSH를 통해 Linux 시스템에 직접 연결할 수 있습니다. 여기에서는 설명을 위해 포트 22가 열려 있습니다. 실제로는 보안 강화를 위해 가상 네트워크에 대한 VPN 액세스를 구성할 수 있습니다.

## <a name="summary"></a>요약

귀하의 3계층 응용 프로그램은 현재 미국 동부 지역의 Azure에서 실행 중입니다. _지역_이란 특정 지리적 위치 내에 있는 Azure 데이터 센터입니다.

각 계층은 하위 계층에서만 서비스에 액세스할 수 있습니다. 웹 계층에서 실행 중인 VM에 공용 IP 주소를 인터넷에서 트래픽을 수신 하기 때문에 더 낮은 계층에서 응용 프로그램 및 데이터 계층 Vm을 각 개인 IP 주소가 인터넷을 통해 직접 통신 하지 때문에 합니다.

_가상 네트워크_를 사용하면 관련 시스템을 그룹화하고 격리할 수 있습니다. 가상 네트워크를 통해 전달될 수 있는 트래픽을 제어하려면 _네트워크 보안 그룹_을 정의합니다.

여기에서 살펴본 구성은 좋은 시작 합니다. 하지만 클라우드에서 프로덕션에 전자 상거래 사이트를 배포할 때 가능성이 실행 같은 문제에 온-프레미스 배포 에서처럼 합니다.
